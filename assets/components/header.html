<header id="header" class="site-header">
  <div class="wrap header-inner">
    <!-- Mobile menu button: visible only on small screens -->
    <button class="mobile-menu-btn" aria-expanded="false" aria-controls="main-nav-list" aria-label="Apri menu">‚ò∞</button>

    <nav class="main-nav" id="main-nav" role="navigation">
      <ul id="main-nav-list">
        <li><a href="index.html">Home</a></li>
        <li><a href="catalogo.html">Catalogo</a></li>
        <li><a href="quiz.html">33Quiz</a></li>
        <li><a href="collaborazioni.html">Collaborazioni</a></li>
        <li><a href="chi_siamo.html">Chi Siamo</a></li>
      </ul>
    </nav>

    <a class="logo" href="index.html" aria-label="33giri logo">
      <img src="assets/logo/33_GIRI._logo-removebg-preview.png" alt="33giri" style="height:120px;">
    </a>

    <div class="header-actions" style="display:flex;align-items:center;gap:18px;">
      <div class="lang-switch" style="font-size:1.1em; letter-spacing:0.04em; display:inline-flex; align-items:center; gap:4px; background:#f7f6f2; border-radius:18px; padding:2px 10px; box-shadow:0 1px 0 rgba(0,0,0,0.03);">
        <span style="font-weight:600; color:#222; display:inline-flex; align-items:center; gap:2px;">
          <img src="https://upload.wikimedia.org/wikipedia/commons/0/03/Flag_of_Italy.svg" alt="IT" style="width:18px; height:13px; vertical-align:middle;"> IT
        </span>
        <span style="color:#888;"> | </span>
        <a href="#" style="color:#222; text-decoration:none; font-weight:400; display:inline-flex; align-items:center; gap:2px;">
          <img src="https://upload.wikimedia.org/wikipedia/commons/a/a4/Flag_of_the_United_States.svg" alt="EN" style="width:18px; height:13px; vertical-align:middle;"> EN
        </a>
      </div>
      <a class="icon-btn" aria-label="Account" href="account.html" role="button">üë§</a>
    </div>
  </div>

  <style>
    /* ===== DESKTOP (default) ===== */
    .site-header {
      position: relative;
      z-index: 100;
      background: #ffffff;
    }

    .wrap.header-inner {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .main-nav {
      margin-left: 16px;
    }

    .main-nav ul {
      display: flex;
      align-items: center;
      gap: 18px;
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .main-nav li {
      margin: 0;
    }

    .main-nav a {
      display: block;
      padding: 6px 8px;
      color: #111;
      text-decoration: none;
      border-radius: 4px;
      font-weight: 500;
    }

    .main-nav a:hover,
    .main-nav a:focus {
      background: #f2f2f2;
    }

    .mobile-menu-btn {
      display: none; /* nascosto su desktop */
    }

    /* ===== MOBILE ===== */
    @media (max-width: 768px) {
      #header {
        position: relative;
        z-index: 2000;
        overflow: visible;
      }

      .wrap.header-inner {
        position: relative;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .mobile-menu-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        background: transparent;
        border: none;
        padding: 8px;
        margin: 0;
        cursor: pointer;
        border-radius: 8px;
      }

      .logo {
        margin: 0 auto;
      }

      /* Base nav mobile: per sicurezza √® visibile se JS non gira */
      .main-nav {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #ffffff;
        box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        border-bottom-left-radius: 8px;
        border-bottom-right-radius: 8px;
        z-index: 2100;
      }

      /* Stato ‚Äúchiuso‚Äù e ‚Äúaperto‚Äù gestito da JS */
      .main-nav.collapsed {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.25s ease-out;
      }

      .main-nav.expanded {
        max-height: 280px; /* adatta se serve */
        overflow: hidden;
        transition: max-height 0.25s ease-out;
      }

      .main-nav ul {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin: 0;
        padding: 12px 16px;
        list-style: none;
      }

      .main-nav a {
        padding: 8px 12px;
      }

      .header-actions {
        margin-left: auto;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const btn = document.querySelector('.mobile-menu-btn');
      const nav = document.getElementById('main-nav');
      const navList = document.getElementById('main-nav-list');

      if (!btn || !nav) return;

      // Su mobile: partiamo con il menu chiuso
      const initMobileState = () => {
        if (window.innerWidth <= 768) {
          nav.classList.add('collapsed');
          nav.classList.remove('expanded');
          btn.setAttribute('aria-expanded', 'false');
          btn.innerText = '‚ò∞';
        } else {
          // Desktop: nav sempre visibile in orizzontale
          nav.classList.remove('collapsed', 'expanded');
          btn.setAttribute('aria-expanded', 'false');
          btn.innerText = '‚ò∞';
        }
      };

      const openMenu = () => {
        nav.classList.remove('collapsed');
        nav.classList.add('expanded');
        btn.setAttribute('aria-expanded', 'true');
        btn.innerText = '‚úï';
      };

      const closeMenu = () => {
        nav.classList.remove('expanded');
        nav.classList.add('collapsed');
        btn.setAttribute('aria-expanded', 'false');
        btn.innerText = '‚ò∞';
      };

      initMobileState();

      btn.addEventListener('click', function(e) {
        e.stopPropagation();
        if (nav.classList.contains('expanded')) {
          closeMenu();
        } else {
          openMenu();
        }
      });

      document.addEventListener('click', function(e) {
        if (!nav.classList.contains('expanded')) return;
        if (nav.contains(e.target) || btn.contains(e.target)) return;
        closeMenu();
      });

      if (navList) {
        navList.addEventListener('click', function(e) {
          const link = e.target.closest('a');
          if (link && window.innerWidth <= 768) {
            closeMenu();
          }
        });
      }

      window.addEventListener('resize', function() {
        initMobileState();
      });
    });
  </script>
</header>
