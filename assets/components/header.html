  <style>
    /* Desktop: resta com'è, niente cambia */
    .mobile-menu-btn { display: none; }

    /* Mobile behaviour */
    @media (max-width: 768px) {
      #header {
        position: relative;
        z-index: 2000;
        overflow: visible; /* importantissimo: non taglia il menu a tendina */
      }

      .wrap.header-inner {
        position: relative;
        display:flex;
        align-items:center;
        gap:12px;
      }

      /* show hamburger button on mobile */
      .mobile-menu-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        background: transparent;
        border: none;
        padding: 8px;
        margin: 0;
        cursor: pointer;
        border-radius: 8px;
      }

      /* visually keep logo centered on mobile */
      .logo {
        margin: 0 auto;
      }

      /* NAV MOBILE – dropdown con max-height */
      .main-nav {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #ffffff;
        box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        border-bottom-left-radius: 8px;
        border-bottom-right-radius: 8px;
        z-index: 2100;

        max-height: 0;          /* chiuso */
        overflow: hidden;
        transition: max-height 0.25s ease-out;
      }

      .main-nav.open {
        max-height: 280px;      /* apre il menu */
      }

      .main-nav ul {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin: 0;
        padding: 12px 16px;
        list-style: none;
      }

      .main-nav li {
        margin: 0;
      }

      .main-nav a {
        display: block;
        padding: 8px 12px;
        color: #111;
        text-decoration: none;
        border-radius: 6px;
      }

      .main-nav a:hover,
      .main-nav a:focus {
        background: #f2f2f2;
      }

      /* keep header-actions (lang + account) visible and aligned to the right */
      .header-actions {
        margin-left: auto;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.log('mobile header script init');

      const btn = document.querySelector('.mobile-menu-btn');
      const nav = document.getElementById('main-nav');
      const navList = document.getElementById('main-nav-list');

      console.log('btn:', btn, 'nav:', nav, 'navList:', navList);

      if (!btn || !nav) return;

      const openMenu = () => {
        nav.classList.add('open');
        btn.setAttribute('aria-expanded', 'true');
        btn.innerText = '✕'; // icona chiusura
      };

      const closeMenu = () => {
        nav.classList.remove('open');
        btn.setAttribute('aria-expanded', 'false');
        btn.innerText = '☰';
      };

      btn.addEventListener('click', function(e) {
        console.log('hamburger click');
        e.stopPropagation();
        if (nav.classList.contains('open')) closeMenu();
        else openMenu();
      });

      // Chiudi cliccando fuori
      document.addEventListener('click', function(e) {
        if (!nav.classList.contains('open')) return;
        if (nav.contains(e.target) || btn.contains(e.target)) return;
        closeMenu();
      });

      // Chiudi quando clicchi un link del menu (più robusto)
      if (navList) {
        navList.addEventListener('click', function(e) {
          const link = e.target.closest('a');
          if (link) closeMenu();
        });
      }

      // Chiudi se si torna a desktop
      window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
          nav.classList.remove('open');
          btn.setAttribute('aria-expanded', 'false');
          btn.innerText = '☰';
        }
      });
    });
  </script>
